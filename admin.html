<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Medic Bingo Admin</title>
</head>

<body>
<h1>ğŸ©º Medic Bingo Control Panel</h1>

<h3>ğŸ“¢ Call a Word</h3>
<button onclick="callRandomWord()">ğŸ² Call Random Word</button>
<p id="lastWord"></p>



<h3>ğŸ” Reset Game</h3>
<button onclick="resetGame()">RESET GAME</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* ğŸ”¥ PASTE YOUR firebaseConfig BELOW (REPLACE THIS ONE) */
const firebaseConfig = {
    apiKey: "AIzaSyDASEWy-s1lBVTiXiJWx7KRvlk_IB1mN24",
    authDomain: "medic-bingo.firebaseapp.com",
    projectId: "medic-bingo",
    storageBucket: "medic-bingo.firebasestorage.app",
    messagingSenderId: "677419756545",
    appId: "1:677419756545:web:099e1928113290c587a400"
  };
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const bingoWords = [
  "Stethoscope","CPR","Bandages","IV Drip","Ambulance",
  "Trauma Kit","Scrubs","Vital Signs","Code Blue","Defibrillator",
  "Syringe","First Responder","Triage","Pulse Check","Oxygen Mask",
  "Heart Monitor","Gloves","Blood Pressure","Paramedic",
  "Emergency Room","Stretchers","Radio Call","Life Support",
  "Medical Chart","Scalpel","Face Mask","Disinfectant",
  "Thermometer","AED","Patient Transport"
];
async function callRandomWord(){
  const ref = db.collection("game").doc("state");
  const doc = await ref.get();

  let called = doc.exists ? doc.data().calledWords : [];

  const remaining = bingoWords.filter(w => !called.includes(w));

  if (remaining.length === 0) {
    alert("All words have been called!");
    return;
  }

  const word = remaining[Math.floor(Math.random() * remaining.length)];
  called.push(word);

  await ref.set({ calledWords: called });

  document.getElementById("lastWord").innerText = "Last called: " + word;
}
    
const select = document.getElementById("word");
bingoWords.forEach(w=>{
  const o=document.createElement("option");
  o.value=w; o.text=w;
  select.appendChild(o);
});

async function callWord(){
  const ref=db.collection("game").doc("state");
  const doc=await ref.get();
  const called=doc.exists?doc.data().calledWords:[];
  const word=select.value;
  if(!called.includes(word)){
    called.push(word);
    await ref.set({calledWords:called});
    alert("Called: "+word);
  }
}

db.collection("players")
  .where("bingo", "==", true)
  .onSnapshot(snapshot => {

    const list = document.getElementById("winners");
    list.innerHTML = "";

    if (snapshot.empty) {
      const li = document.createElement("li");
      li.innerText = "No winners yet";
      list.appendChild(li);
      return;
    }

    snapshot.forEach(doc => {
      const li = document.createElement("li");
      li.innerText = `${doc.id} â€” ${doc.data().time}`;
      list.appendChild(li);
    });
  });
    
async function resetGame(){
  if(!confirm("Reset everything?")) return;
  const players=await db.collection("players").get();
  players.forEach(d=>d.ref.delete());
  await db.collection("game").doc("state").set({calledWords:[]});
  alert("Game reset!");
}

// ğŸ”´ REAL-TIME WINNER LISTENER (AUTO UPDATE)
db.collection("players")
 .where("bingo", "==", true)
 .onSnapshot(snapshot => {

   const list = document.getElementById("winners");
   list.innerHTML = "";

   if (snapshot.empty) {
     const li = document.createElement("li");
     li.innerText = "No winners yet";
     list.appendChild(li);
     return;
   }

   snapshot.forEach(doc => {
     const li = document.createElement("li");
     li.innerText = ${doc.id} â€” ${doc.data().time};
     list.appendChild(li);
   });
 });
</script>

</body>
</html>



