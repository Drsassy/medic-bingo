<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medic Bingo â€“ Admin</title>

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg,#eef2f7,#ffffff);
  padding: 30px;
}
h1,h2 { color:#c62828; }
.card {
  background: white;
  border-radius: 18px;
  padding: 24px;
  margin-bottom: 22px;
  max-width: 760px;
  box-shadow: 0 15px 40px rgba(0,0,0,.12);
}
input,button {
  padding: 14px;
  border-radius: 12px;
  border: none;
  font-weight: bold;
}
button {
  background:#c62828;
  color:white;
  cursor:pointer;
}
button.reset { background:#000; }
ul li {
  background:#f7fdfc;
  padding:10px;
  border-radius:10px;
  margin-bottom:6px;
}
</style>
</head>

<body>

<h1>ğŸ©º Medic Bingo â€” Admin</h1>

<!-- LOGIN -->
<div class="card" id="login">
  <h2>ğŸ” Admin Login</h2>
  <input id="username" placeholder="Username"><br><br>
  <input id="password" type="password" placeholder="Password"><br><br>
  <button onclick="login()">Login</button>
</div>

<!-- PANEL -->
<div id="panel" style="display:none;">

  <div class="card">
    <h2>ğŸ² Call Next Word</h2>
    <button onclick="callNext()">Call Word</button>
    <p id="lastCall"><em>Nothing called yet</em></p>
  </div>

  <div class="card">
    <h2>ğŸ† Winners</h2>
    <ul id="winners"><li>None yet</li></ul>
  </div>

  <div class="card">
    <h2>ğŸ” Reset Game</h2>
    <button class="reset" onclick="resetGame()">RESET GAME</button>
  </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyDASEWy-s1lBVTiXiJWx7KRvlk_IB1mN24",
    authDomain: "medic-bingo.firebaseapp.com",
    projectId: "medic-bingo",
    storageBucket: "medic-bingo.firebasestorage.app",
    messagingSenderId: "677419756545",
    appId: "1:677419756545:web:099e1928113290c587a400"
  };

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ğŸ” LOGIN */
function login(){
  const u = document.getElementById("username").value;
  const p = document.getElementById("password").value;
  if(u==="sassy123" && p==="sassyontop"){
    document.getElementById("login").style.display="none";
    document.getElementById("panel").style.display="block";
  } else {
    alert("Incorrect login");
  }
}

/* ğŸ©º WORD LIST */
const WORDS = [
  "Stethoscope","Blood Pressure Cuff","Pulse Oximeter","Thermometer",
  "Defibrillator","AED","IV Pump","IV Drip","Syringe","Needle",
  "Oxygen Tank","Oxygen Mask","Bag Valve Mask","Ventilator",
  "Heart Monitor","ECG Leads","Ultrasound","Laryngoscope",
  "Suction Unit","Crash Cart",

  "Gloves","Face Mask","Gown","Visor","Sanitiser",
  "Disinfectant","Sharps Bin","Biohazard Bag","Sterile Field",
  "Dressings","Bandages","Gauze","Tourniquet","Splint",
  "Cervical Collar","Backboard",

  "CPR","Intubation","Cannulation","Blood Draw",
  "Airway Management","Oxygen Therapy","Fluid Resuscitation",
  "Wound Cleaning","Suturing","Manual Ventilation",
  "Defib Shock","Vitals Check","Pain Assessment","Neuro Check",

  "Paramedic","EMT","First Responder","Charge Nurse",
  "Triage Nurse","Consultant","Registrar","Medical Student",

  "Emergency Room","Resus Bay","Trauma Room","ICU",
  "Ambulance","Helipad","Operating Theatre",

  "Code Blue","Cardiac Arrest","Sepsis","Stroke Alert",
  "Major Trauma","Anaphylaxis","Unconscious Patient",

  "Medical Chart","Radio Call","Patient Transfer",
  "Life Support","Night Shift","Blue Light Run","Sirens On"
];

/* GAME STATE */
db.collection("game").doc("state").set({
  called: [],
  resetCounter: 0
},{merge:true});

async function callNext(){
  const ref = db.collection("game").doc("state");
  const data = (await ref.get()).data();

  const remaining = WORDS.filter(w => !data.called.includes(w));
  if(!remaining.length) return alert("All words called");

  const pick = remaining[Math.floor(Math.random()*remaining.length)];
  await ref.update({ called:[...data.called, pick] });

  document.getElementById("lastCall").innerText =
    "Last called: " + pick;
}

async function resetGame(){
  const players = await db.collection("players").get();
  players.forEach(p=>p.ref.delete());

  await db.collection("game").doc("state").update({
    called:[],
    resetCounter:firebase.firestore.FieldValue.increment(1)
  });
}

/* WINNERS */
db.collection("players").where("bingo","==",true)
.onSnapshot(snap=>{
  const ul=document.getElementById("winners");
  ul.innerHTML=snap.empty?"<li>None yet</li>":"";
  snap.forEach(d=>ul.innerHTML+=`<li>${d.id}</li>`);
});
</script>
</body>
</html>
