<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medic Bingo Admin</title>

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg, #eaf6f6, #ffffff);
  padding: 30px;
  color: #333;
}

h1 {
  color: #b71c1c;
  margin-bottom: 5px;
}

h2 {
  color: #b71c1c;
  margin-top: 0;
}

.subtitle {
  color: #555;
  margin-bottom: 20px;
}

.card {
  background: white;
  border-radius: 14px;
  padding: 22px;
  margin-bottom: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  max-width: 650px;
}

button {
  padding: 12px 20px;
  font-size: 15px;
  font-weight: bold;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: #b71c1c;
  color: white;
  transition: all 0.2s ease;
}

button:hover {
  background: #d32f2f;
  transform: translateY(-1px);
}

button.reset {
  background: #000;
}

input {
  padding: 12px;
  font-size: 15px;
  border-radius: 8px;
  border: 1px solid #ccc;
  width: 100%;
  max-width: 320px;
  margin-bottom: 10px;
}

#winners li {
  background: #f7fdfc;
  padding: 10px 14px;
  border-radius: 8px;
  margin-bottom: 8px;
  font-weight: bold;
}

#lastWord {
  font-size: 18px;
  font-weight: bold;
  margin-top: 10px;
}

#adminPanel {
  display: none;
}
</style>
</head>

<body>

<h1>ü©∫ Medic Bingo</h1>
<p class="subtitle">Admin Control Panel</p>

<!-- üîê LOGIN -->
<div id="login" class="card">
  <h2>Admin Login</h2>

  <input id="username" type="text" placeholder="Username">
  <input id="password" type="password" placeholder="Password">

  <br>
  <button onclick="login()">Login</button>
  <p id="loginError" style="color:red;"></p>
</div>

<!-- üéõ ADMIN PANEL -->
<div id="adminPanel">

  <div class="card">
    <h2>üé≤ Call Random Word</h2>
    <button onclick="callRandomWord()">Call Random Word</button>
    <p id="lastWord"><em>No word called yet</em></p>
  </div>

  <div class="card">
    <h2>üèÜ Winners (Live)</h2>
    <ul id="winners">
      <li>No winners yet</li>
    </ul>
  </div>

  <div class="card">
    <h2>üîÅ Reset Game</h2>
    <button class="reset" onclick="resetGame()">RESET GAME</button>
  </div>

</div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* üîê ADMIN CREDENTIALS */
const ADMIN_USER = "sassy123";
const ADMIN_PASS = "sassyontop";

function login() {
  const u = document.getElementById("username").value;
  const p = document.getElementById("password").value;

  if (u === ADMIN_USER && p === ADMIN_PASS) {
    document.getElementById("login").style.display = "none";
    document.getElementById("adminPanel").style.display = "block";
  } else {
    document.getElementById("loginError").innerText = "Invalid username or password";
  }
}

/* üî• FIREBASE CONFIG ‚Äî REPLACE WITH YOUR REAL ONE */
const firebaseConfig = {
    apiKey: "AIzaSyDASEWy-s1lBVTiXiJWx7KRvlk_IB1mN24",
    authDomain: "medic-bingo.firebaseapp.com",
    projectId: "medic-bingo",
    storageBucket: "medic-bingo.firebasestorage.app",
    messagingSenderId: "677419756545",
    appId: "1:677419756545:web:099e1928113290c587a400"
  };

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* Ensure game state exists */
db.collection("game").doc("state").set({
  calledWords: [],
  resetCounter: 0
}, { merge: true });

/* ü©∫ MEDIC BINGO WORDS */
const bingoWords = [
  "Stethoscope","CPR","Bandages","IV Drip","Ambulance",
  "Trauma Kit","Scrubs","Vital Signs","Code Blue","Defibrillator",
  "Syringe","First Responder","Triage","Pulse Check","Oxygen Mask",
  "Heart Monitor","Gloves","Blood Pressure","Paramedic",
  "Emergency Room","Stretchers","Radio Call","Life Support",
  "Medical Chart","Scalpel","Face Mask","Disinfectant",
  "Thermometer","AED","Patient Transport"
];

/* üé≤ CALL RANDOM WORD */
async function callRandomWord() {
  const ref = db.collection("game").doc("state");
  const doc = await ref.get();
  const called = doc.exists ? doc.data().calledWords : [];

  const remaining = bingoWords.filter(w => !called.includes(w));
  if (remaining.length === 0) {
    alert("All words have been called!");
    return;
  }

  const word = remaining[Math.floor(Math.random() * remaining.length)];
  called.push(word);

  await ref.update({ calledWords: called });
  document.getElementById("lastWord").innerText = "Last called: " + word;
}

/* üèÜ LIVE WINNER LIST */
db.collection("players")
  .where("bingo", "==", true)
  .onSnapshot(snapshot => {
    const list = document.getElementById("winners");
    list.innerHTML = "";

    if (snapshot.empty) {
      list.innerHTML = "<li>No winners yet</li>";
      return;
    }

    snapshot.forEach(doc => {
      const li = document.createElement("li");
      li.innerText = `${doc.id} ‚Äî ${doc.data().time}`;
      list.appendChild(li);
    });
  });

/* üîÅ RESET GAME */
async function resetGame() {
  if (!confirm("Are you sure you want to reset the entire game?")) return;

  const players = await db.collection("players").get();
  players.forEach(doc => doc.ref.delete());

  const ref = db.collection("game").doc("state");
  const doc = await ref.get();
  const resetCounter = doc.exists && doc.data().resetCounter
    ? doc.data().resetCounter + 1
    : 1;

  await ref.set({
    calledWords: [],
    resetCounter: resetCounter
  }, { merge: true });

  document.getElementById("lastWord").innerText = "No word called yet";
  alert("Game reset");
}
</script>

</body>
</html>
